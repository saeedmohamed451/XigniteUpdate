(function(d){var g={type:"html",content:"",url:"",ajax:{},ajax_request:null,closeOnEsc:true,closeOnOverlayClick:true,clone:false,overlay:{block:undefined,tpl:'<div class="arcticmodal-overlay"></div>',css:{backgroundColor:"#000",opacity:0.6}},container:{block:undefined,tpl:'<div class="arcticmodal-container"><div class="arcticmodal-container_i"><div><div class="arcticmodal-container_i2"></div></div></div></div>'},wrap:undefined,body:undefined,errors:{tpl:'<div class="arcticmodal-error arcticmodal-close"></div>',autoclose_delay:2000,ajax_unsuccessful_load:"Error"},openEffect:{type:"fade",speed:400},closeEffect:{type:"fade",speed:400},beforeOpen:d.noop,afterOpen:d.noop,beforeClose:d.noop,afterClose:d.noop,afterLoading:d.noop,afterLoadingOnShow:d.noop,errorLoading:d.noop};var f=0;var b=d([]);var a={isEventOut:function(j,i){var h=true;d(j).each(function(){if(d(i.target).get(0)==d(this).get(0)){h=false}if(d(i.target).closest("HTML",d(this).get(0)).length==0){h=false}});return h}};var c={getParentEl:function(h){var i=d(h);if(i.data("arcticmodal")){return i}i=d(h).closest(".arcticmodal-container").data("arcticmodalParentEl");if(i){return i}return false},transition:function(i,j,h,k){k=k==undefined?d.noop:k;switch(h.type){case"fade":j=="show"?i.fadeIn(h.speed,k):i.fadeOut(h.speed,k);break;case"none":j=="show"?i.show():i.hide();k();break}},prepare_body:function(i,h){d(".arcticmodal-close",i.body).unbind("click.arcticmodal").bind("click.arcticmodal",function(){h.arcticmodal("close");return false})},init_el:function(m,i){var l=m.data("arcticmodal");if(l){return}l=i;f++;l.modalID=f;l.overlay.block=d(l.overlay.tpl);l.overlay.block.css(l.overlay.css);l.container.block=d(l.container.tpl);l.body=d(".arcticmodal-container_i2",l.container.block);if(i.clone){l.body.html(m.clone(true))}else{m.before('<div id="arcticmodalReserve'+l.modalID+'" style="display: none" />');l.body.html(m)}c.prepare_body(l,m);if(l.closeOnOverlayClick){l.overlay.block.add(l.container.block).click(function(o){if(a.isEventOut(d(">*",l.body),o)){m.arcticmodal("close")}})}l.container.block.data("arcticmodalParentEl",m);m.data("arcticmodal",l);b=d.merge(b,m);d.proxy(e.show,m)();if(l.type=="html"){return m}if(l.ajax.beforeSend!=undefined){var k=l.ajax.beforeSend;delete l.ajax.beforeSend}if(l.ajax.success!=undefined){var h=l.ajax.success;delete l.ajax.success}if(l.ajax.error!=undefined){var j=l.ajax.error;delete l.ajax.error}var n=d.extend(true,{url:l.url,beforeSend:function(){if(k==undefined){l.body.html('<div class="arcticmodal-loading" />')}else{k(l,m)}},success:function(o){m.trigger("afterLoading");l.afterLoading(l,m,o);if(h==undefined){l.body.html(o)}else{h(l,m,o)}c.prepare_body(l,m);m.trigger("afterLoadingOnShow");l.afterLoadingOnShow(l,m,o)},error:function(){m.trigger("errorLoading");l.errorLoading(l,m);if(j==undefined){l.body.html(l.errors.tpl);d(".arcticmodal-error",l.body).html(l.errors.ajax_unsuccessful_load);d(".arcticmodal-close",l.body).click(function(){m.arcticmodal("close");return false});if(l.errors.autoclose_delay){setTimeout(function(){m.arcticmodal("close")},l.errors.autoclose_delay)}}else{j(l,m)}}},l.ajax);l.ajax_request=d.ajax(n);m.data("arcticmodal",l)},init:function(h){h=d.extend(true,{},g,h);if(d.isFunction(this)){if(h==undefined){d.error("jquery.arcticmodal: Uncorrect parameters");return}if(h.type==""){d.error('jquery.arcticmodal: Don\'t set parameter "type"');return}switch(h.type){case"html":if(h.content==""){d.error('jquery.arcticmodal: Don\'t set parameter "content"');return}var i=h.content;h.content="";return c.init_el(d(i),h);break;case"ajax":if(h.url==""){d.error('jquery.arcticmodal: Don\'t set parameter "url"');return}return c.init_el(d("<div />"),h);break}}else{return this.each(function(){c.init_el(d(this),d.extend(true,{},h))})}}};var e={show:function(){var k=c.getParentEl(this);if(k===false){d.error("jquery.arcticmodal: Uncorrect call");return}var j=k.data("arcticmodal");j.overlay.block.hide();j.container.block.hide();d("BODY").append(j.overlay.block);d("BODY").append(j.container.block);j.beforeOpen(j,k);k.trigger("beforeOpen");if(j.wrap.css("overflow")!="hidden"){j.wrap.data("arcticmodalOverflow",j.wrap.css("overflow"));var i=j.wrap.outerWidth(true);j.wrap.css("overflow","hidden");var h=j.wrap.outerWidth(true);if(h!=i){j.wrap.css("marginRight",(h-i)+"px")}}b.not(k).each(function(){var l=d(this).data("arcticmodal");l.overlay.block.hide()});c.transition(j.overlay.block,"show",b.length>1?{type:"none"}:j.openEffect);c.transition(j.container.block,"show",b.length>1?{type:"none"}:j.openEffect,function(){j.afterOpen(j,k);k.trigger("afterOpen")});return k},close:function(){if(d.isFunction(this)){b.each(function(){d(this).arcticmodal("close")})}else{return this.each(function(){var i=c.getParentEl(this);if(i===false){d.error("jquery.arcticmodal: Uncorrect call");return}var h=i.data("arcticmodal");if(h.beforeClose(h,i)===false){return}i.trigger("beforeClose");b.not(i).last().each(function(){var j=d(this).data("arcticmodal");j.overlay.block.show()});c.transition(h.overlay.block,"hide",b.length>1?{type:"none"}:h.closeEffect);c.transition(h.container.block,"hide",b.length>1?{type:"none"}:h.closeEffect,function(){h.afterClose(h,i);i.trigger("afterClose");if(!h.clone){d("#arcticmodalReserve"+h.modalID).replaceWith(h.body.find(">*"))}h.overlay.block.remove();h.container.block.remove();i.data("arcticmodal",null);if(!d(".arcticmodal-container").length){if(h.wrap.data("arcticmodalOverflow")){h.wrap.css("overflow",h.wrap.data("arcticmodalOverflow"))}h.wrap.css("marginRight",0)}});if(h.type=="ajax"){h.ajax_request.abort()}b=b.not(i)})}},setDefault:function(h){d.extend(true,g,h)}};d(function(){g.wrap=d((document.all&&!document.querySelector)?"html":"body")});d(document).bind("keyup.arcticmodal",function(j){var h=b.last();if(!h.length){return}var i=h.data("arcticmodal");if(i.closeOnEsc&&(j.keyCode===27)){h.arcticmodal("close")}});d.arcticmodal=d.fn.arcticmodal=function(h){if(e[h]){return e[h].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof h==="object"||!h){return c.init.apply(this,arguments)}else{d.error("jquery.arcticmodal: Method "+h+" does not exist")}}}})(jQuery);